diff -rup nginx-1.13.6/src/stream/ngx_stream_proxy_module.c nginx-1.13.6.new/src/stream/ngx_stream_proxy_module.c
--- nginx-1.13.6/src/stream/ngx_stream_proxy_module.c	2017-10-10 11:22:53.000000000 -0400
+++ nginx-1.13.6.new/src/stream/ngx_stream_proxy_module.c	2017-11-14 04:12:17.543578163 -0500
@@ -1015,6 +1015,13 @@ ngx_stream_proxy_ssl_init_connection(ngx
         }
     }
 
+    ngx_ssl_conn_t *ssl = pc->ssl->connection;
+    SSL_enable_tls_channel_id(ssl);
+    const u_char alpn_str[] = "\x02h2\x08http/1.1";
+    SSL_set_alpn_protos(ssl, alpn_str, sizeof(alpn_str) - 1);
+    SSL_enable_signed_cert_timestamps(ssl);
+    SSL_enable_ocsp_stapling(ssl);
+
     if (pscf->ssl_session_reuse) {
         if (u->peer.set_session(&u->peer, u->peer.data) != NGX_OK) {
             ngx_stream_proxy_finalize(s, NGX_STREAM_INTERNAL_SERVER_ERROR);
@@ -1961,6 +1968,8 @@ ngx_stream_proxy_set_ssl(ngx_conf_t *cf,
         return NGX_ERROR;
     }
 
+    SSL_CTX_set_grease_enabled(pscf->ssl->ctx, 1);
+
     cln = ngx_pool_cleanup_add(cf->pool, 0);
     if (cln == NULL) {
         return NGX_ERROR;
